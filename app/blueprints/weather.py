# app/blueprints/weather.py
from flask import Blueprint, render_template

bp = Blueprint("weather", __name__)

CAL_DATA = {
    "المواسم": [
        {"id":"all",     "name":"الكل"},
        {"id":"winter",  "name":"الشتاء"},
        {"id":"hotdry",  "name":"الصيف (حار وجاف)"},
        {"id":"rainy",   "name":"الخريف"},
        {"id":"autumn",  "name":"الخريف المتأخر / الربيع"}
    ],
    "المناطق": ["الجزيرة", "نهر النيل", "الشمالية", "دارفور", "الخرطوم"],
    "الشهور": [
        {"m":"يناير","s":"winter","crops":["قمح: ري خفيف + نيتروجين بسيط","جرجير/فجل/خس — زراعة/شتل"],"details":"جو بارد؛ خفف الري وتجنب الغمر.","regions":{"الجزيرة":["قمح: رية كل 10-12 يوم"],"نهر النيل":["بصل: عزيق خفيف"],"الشمالية":["برد أعلى: قلل الري"],"دارفور":["خضروات شتوية صغيرة"],"الخرطوم":["حدائق: ورقيات"]}},
        {"m":"فبراير","s":"winter","crops":["بصل: عزيق ومكافحة حشائش","بطاطس: تسميد متوازن"],"details":"استقرار شتوي مع سخانة بسيطة آخر الشهر.","regions":{"الجزيرة":["بصل أبكر: توازن ري/تسميد"],"نهر النيل":["بطاطس: بوتاسيوم خفيف"],"الشمالية":["ري صباح/ظهر"],"دارفور":["جرجير/بقدونس"],"الخرطوم":["بطاطس حدائق"]}},
        {"m":"مارس","s":"hotdry","crops":["بداية سخانة: ظل للشتلات","تجهيز أرض الصيف"],"details":"انتقال للصيف؛ ري صغير متقارب.","regions":{"الجزيرة":["طماطم مبكرة"],"نهر النيل":["ملش وتظليل"],"الشمالية":["عدّل الري نهار/ليل"],"دارفور":["تجهيز ذرة رفيعة"],"الخرطوم":["بامية/طماطم حدائق"]}},
        {"m":"أبريل","s":"hotdry","crops":["طماطم/بامية صيفية","ذرة رفيعة مبكرة"],"details":"تبخر عالي؛ اسقِ صباح/مساء.","regions":{"الجزيرة":["بامية/ملوخية"],"نهر النيل":["طماطم ظل جزئي"],"الشمالية":["راقب الملوحة"],"دارفور":["تجهيزات مطرية"],"الخرطوم":["خيار/باذنجان"]}},
        {"m":"مايو","s":"hotdry","crops":["استعداد للخريف: صيانة مصارف","بطيخ مبكّر"],"details":"حرارة عالية؛ أجزاء ري صغيرة.","regions":{"الجزيرة":["بطيخ مبكر"],"نهر النيل":["بستانيات مقاومة حرارة"],"الشمالية":["ترشيد الري"],"دارفور":["تقاوي ذرة/سمسم"],"الخرطوم":["بطيخ قزمي/شمام"]}},
        {"m":"يونيو","s":"hotdry","crops":["التحضير قبل الأمطار","تأمين تقاوي ذرة/سمسم/فول"],"details":"قرب الخريف؛ صرف ممتاز.","regions":{"الجزيرة":["تجهيز حقول الخريف"],"نهر النيل":["إدارة ملوحة"],"الشمالية":["حرارة جافة"],"دارفور":["مواعيد حسب المطر"],"الخرطوم":["صيانة مضخات"]}},
        {"m":"يوليو","s":"rainy","crops":["بدء الخريف: ذرة/سمسم/فول","تنقية مصارف"],"details":"أمطار بتزيد؛ تجنب العمل فوق تربة مشبعة.","regions":{"الجزيرة":["ذرة/فول على المطر"],"نهر النيل":["صرف جيد"],"الشمالية":["خريف محدود"],"دارفور":["ذرة/سمسم أساسية"],"الخرطوم":["ذرة للأحواش"]}},
        {"m":"أغسطس","s":"rainy","crops":["بطيخ: وقت مناسب","تسميد ذرة/سمسم","وقاية فطرية"],"details":"رطوبة عالية؛ زوّد صرف.","regions":{"الجزيرة":["بطيخ/حبّان"],"نهر النيل":["ري تكميلي"],"الشمالية":["زراعات محدودة"],"دارفور":["بطيخ/بامية/ملوخية"],"الخرطوم":["حذر من أعفان"]}},
        {"m":"سبتمبر","s":"rainy","crops":["بطيخ/بامية/ملوخية","ذرة: تسميد خفيف"],"details":"نهاية خريف؛ الماء الواقف خطر.","regions":{"الجزيرة":["استكمال محاصيل الخريف"],"نهر النيل":["تحضير الشتوي"],"الشمالية":["تهيئة أراضي الشتاء"],"دارفور":["تنظيف الحشائش"],"الخرطوم":["تخفيف رطوبة التربة"]}},
        {"m":"أكتوبر","s":"autumn","crops":["طماطم/بصل: بداية موسم","زراعة شتوية مبكّرة"],"details":"جو معتدل؛ نافذة ممتازة للشتوي.","regions":{"الجزيرة":["بصل مبكر/طماطم"],"نهر النيل":["طماطم مع برد خفيف"],"الشمالية":["بدايات شتوية"],"دارفور":["خضروات شتوية بسيطة"],"الخرطوم":["تسميد فوسفاتي"]}},
        {"m":"نوفمبر","s":"winter","crops":["قمح: أحسن وقت","فول مصري/حمص"],"details":"التوقيت الذهبي للقمح.","regions":{"الجزيرة":["قمح أساسي"],"نهر النيل":["قمح مبكر ناجح"],"الشمالية":["قمح مع برد"],"دارفور":["قمح محدود"],"الخرطوم":["قمح حدائق"]}},
        {"m":"ديسمبر","s":"winter","crops":["خضروات ورقية شتوية","ري خفيف"],"details":"برد واضح؛ قلّل الري ووازن التسميد.","regions":{"الجزيرة":["ملش يقلل تبخر"],"نهر النيل":["حماية شتلات"],"الشمالية":["احتمال صقيع"],"دارفور":["تسميد عضوي"],"الخرطوم":["مراقبة فطريات"]}}
    ]
}

@bp.get("/weather")
def planting_calendar():
    return render_template("main/weather.html", cal=CAL_DATA)
