{% extends "base.html" %}
{% block title %}تشخيص صحي{% endblock %}
{% block content %}
<h3 class="mb-3">تشخيص صحة المحصول</h3>
<form method="post" novalidate class="mb-3">
  {{ form.hidden_tag() }}
  <div class="row g-3">
    <div class="col-md-4">
      {{ form.symptom_selected.label(class="form-label") }}
      {{ form.symptom_selected(class="form-select") }}
    </div>
    <div class="col-md-4">
      {{ form.soil_moisture_level.label(class="form-label") }}
      {{ form.soil_moisture_level(class="form-control", placeholder="مثال: 25") }}
    </div>
    <div class="col-12">
      {{ form.notes.label(class="form-label") }}
      {{ form.notes(class="form-control") }}
    </div>
  </div>
  <div class="mt-3">{{ form.submit(class="btn btn-success") }}</div>
</form>

{% if result %}
<div class="card">
  <div class="card-body">
    <h5 class="card-title">نتيجة مبدئية</h5>
    <p class="mb-1"><b>التشخيص:</b> {{ result.diagnosis }} (ثقة ~ {{ (result.confidence_score * 100)|round(0) }}%)</p>
    <p class="mb-1"><b>توصية:</b> {{ result.recommendation }}</p>
    <p class="text-muted small mb-0">هذه نتيجة تقريبية، ارفع صور الأوراق لتحليل أدق لاحقًا.</p>
  </div>
</div>
{% endif %}
{% endblock %}
